# Rebellious Aging – Project Overview

## Stack & Tooling
- **Frontend:** React 18 + TypeScript, migrated to Next.js 14 App Router (`app/`), static-first export mode.
- **Routing:** File-based routes under `app/` with metadata-driven routes for SEO parity (`generateMetadata`) and legacy route compatibility.
- **Styling/UI:** Tailwind CSS, shadcn/ui primitives (Radix), Framer Motion.
- **State/Async:** TanStack Query and shared shadcn/Toast patterns for feedback, with page-level lazy loading for embeds.
- **SEO/Indexing:** `src/lib/seo.ts`, `src/lib/nextMetadata.ts`, route metadata in `src/data/seoRoutes.ts`, search index generation via `scripts/build-search-index.ts`.
- **Build/Release:** `npm run build` runs `npm run sitemap`, `npm run build:search`, `next build`, and `npm run prerender` (audit validation).
- **Analytics/Embeds:** GA, Hotjar, and GPT Engineer toggled via environment flags and inserted in `src/app/layout.tsx` via `next/script`.
- **SEO Ops Guide:** `docs/seo-best-practices-nextjs-vercel-2026.md` documents the current Search Console + deployment operating model.

## Routing & Features
- **Entry/structure:** `app/layout.tsx` provides global providers and layout chrome; page UIs remain in `src/pages`.
- **Core pages:**  
  - Home, Our Story, Welcome Letter, Starter Kit, Nutrition, Video Series, Pillars (dynamic), Recipe listing/detail, Blog listing/detail, Search, Team, Contact, Facebook Group, and not-found flows.
- **Special routing behavior:** `/pillars/longevity` redirects to `/pillars/health` via Vercel/App Router routing configuration.
- **Reusable CTAs:** `ConnectCTA`, `WelcomeBanner`, `VideoCard`, `MobileMenuSection`, `GallerySection`, and shared content modules.

## Data & Integrations
- **Static content:** Blog metadata (`src/data/blogPosts.ts`), pillar copy, video series, and recipe indexes are maintained in deterministic TS modules.
- **Canonical route metadata:** `src/data/seoRoutes.ts` drives per-route SEO defaults.
- **Supabase:** `src/components/pillar/QuizSection.tsx` uses the `submit-quiz` Edge Function; table/policies reside in `supabase/migrations/`.
- **Typeform:** Contact/newsletter embeds load on interaction; quiz scripts are intersection-triggered and global cached.
- **Facebook CTA:** Central helper in `src/lib/facebook.ts` keeps popup + fallback behavior consistent.

## SEO & Operations
- `src/lib/seo.ts` and `src/lib/siteMetadata.ts` provide base metadata helpers.
- `src/lib/nextMetadata.ts` converts route metadata into Next `Metadata`.
- `src/components/seo/Seo.tsx` and script utilities are retained for non-route flows; route-level tags are now driven by Next Metadata and JSON-LD injection where needed.
- `scripts/prerender.tsx` performs SEO route audit and emits `public/seo-route-audit.json` for route coverage checks.
- `scripts/generate-sitemap.ts` writes `public/sitemap.xml`; `public/search-index.json` is generated by `scripts/build-search-index.ts`.
- `scripts/production-readiness.ts` validates sitemap, search index, metadata completeness, and outbound link hardening; output is written to `public/production-readiness-report.json`.
- `app/robots.ts` now controls crawler directives and sitemap declaration under Next.js file conventions.
- `app/not-found.tsx` enforces `noindex, nofollow` for unexpected/404 URLs.
- `NEXT_PUBLIC_GOOGLE_SITE_VERIFICATION` feeds Google verification content into page metadata (Search Console metadata method).
- GA ID is controlled by `NEXT_PUBLIC_GA_ID`; GA loading is environment-gated in `app/layout.tsx`.
- `npm run readiness:verify` and `npm run test:e2e:readiness` include a smoke check for SEO-sensitive assets (`sitemap.xml`, `seo-route-audit.json`, `search-index.json`).
- Readiness command sets now include:
  - `npm run readiness:verify` (full gate)
  - `npm run test:e2e:readiness` (unit and browser pass)
  - `npm run test:e2e:perf` (web-vital smoke by route)
- These checks are part of the current launch criteria before publishing static output.

## Operational Notes
- Route coverage and SEO parity are validated during build with the repurposed prerender step.
- Deployment target is Vercel static export (`/out`), with runtime compatibility safeguards in `next.config.js`.
- GitHub source of truth is `enzo-prism/rebellious-aging`; legacy references should stay in historical notes only.

## Recently Added/Noted Context
- Last migration focus: Vite SPA → Next.js App Router conversion with static-first export strategy.
- Keep `npm run build` as the canonical verification command after content/route changes.
- Blog post ordering behavior mirrors the original repo ordering contract: `blogPosts` entries are normalized and `getNextBlogPost` resolves by `blogNumber`, not by array position.

## Opportunities & Caveats
1. The long-form blog content remains in `src/pages/BlogPost.tsx` (single renderer); consider extracting per-post modules for contributor scale.
2. Ensure `src/data/seoRoutes.ts` and dynamic route params stay in sync when adding content routes.
3. Tests are now expanded across unit, component, accessibility, and readiness routes, but coverage should continue to grow as content and integrations expand.
4. Analytics and third-party script settings should stay env-gated for secure preview behavior.

Sparkle on! ✨
